var Engine = require('tingodb')();
var collections =[];
var database =new Engine.Db('db', {});
var logger=require("logger");
var log="db.js";
module.exports = {
	engine : Engine,
	db : database,
	collection_list : collections,
	populate : function() {
		//Exemple about words
		/*collection = database.collection("words");
		collection.remove({});
		collections.push("words");
		collection.insert([{word:'the', frequency : 10}, {word:'a', frequency : 8}, {word:'believe', frequency : 5, cluster : [1,2]}, {word:'prediction', frequency : 2}, {word:'feeling', frequency : 4}, {word:'then', frequency : 6}]);
		*/
		//For Diachrony-------------------------------------------------------------------------------------
		//Contains expe details such as period number*************************
		collection = database.collection("experiment");
		collections.push("experiment");
		//Contains sclu files*************************************************
		collection = database.collection("clusterDesc");
		collections.push("clusterDesc");
		//Contains dcsl files*************************************************
		collection = database.collection("clusterFeatures");
		collections.push("clusterFeatures");
		//Contains json diachrony files files*************************************************
		collection = database.collection("diachrony");
		collections.push("diachrony");
		//Contains arff files*************************************************
		collection = database.collection("indexation");
		collections.push("indexation");

	},
	find : function(collection) {
		return database.collection(collection).find({});
	},
	/*findWhere : function() {
		where=Object();
		where.cluster ="1";
		where.period="2";
		var res=database.collection("clusterFeatures").find(where);
		res.each(function(err,item) {
			logger.debug(item);
		});
	},*/
	findWhere : function(collection, where) {
		var res=database.collection(collection).find(where);
		return res;
	},
	insert : function(collection, values) {
		collection=database.collection(collection);
		collection.insert(values);
	},
	remove : function(collection, values) {
		database.collection(collection).remove(values);
	},
	//agregate not supported by TingoDB
	//Still, it would be supported if using MongoDB, and in further versions of TingoDB
	aggregate : function (collection, aggregat) {
		return database.collection(collection).aggregate([{ "$group" : {  aggregat	}	}]	);
	},
	clear : function(collectionName) {
		collection=database.collection(collectionName);
		collection.remove({});
	},
	clearAll : function() {
		for (i in collections) {
			this.clear(collections[i]);
		}
	}
};
